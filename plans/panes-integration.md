# –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –ø–∞–Ω–µ–ª–µ–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π drag-and-drop

## –¶–µ–ª—å

–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å drag-and-drop –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞–Ω–µ–ª–µ–π (–ø–æ–¥–æ–±–Ω–æ —Ç–∞–π–ª–∏–Ω–≥–æ–≤—ã–º –æ–∫–æ–Ω–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º), **—Ç–æ–ª—å–∫–æ –¥–ª—è desktop**.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [x] –¢–æ–ª—å–∫–æ –¥–ª—è desktop –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (mobile –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- [x] Drag-and-drop –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–∞–Ω–µ–ª–µ–π
- [x] 5 –∑–æ–Ω —Å–±—Ä–æ—Å–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏:
  - [x] –õ–µ–≤—ã–π –∫—Ä–∞–π (15%) - —Å–æ–∑–¥–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π split —Å–ª–µ–≤–∞
  - [x] –ü—Ä–∞–≤—ã–π –∫—Ä–∞–π (15%) - —Å–æ–∑–¥–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π split —Å–ø—Ä–∞–≤–∞
  - [x] –í–µ—Ä—Ö–Ω–∏–π –∫—Ä–∞–π (15%) - —Å–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π split —Å–≤–µ—Ä—Ö—É
  - [x] –ù–∏–∂–Ω–∏–π –∫—Ä–∞–π (15%) - —Å–æ–∑–¥–∞—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π split —Å–Ω–∏–∑—É
  - [x] –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∑–æ–Ω–∞ (40%) - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–∫–ª–∞–¥–∫—É –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
- [x] –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ü–µ–ª–µ–≤–æ–π –∑–æ–Ω—ã –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
- [x] –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–Ω–µ–ª–∏: 15%
- [x] –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–∫–ª–∞–¥–∫–∏ –≤ –ø–∞–Ω–µ–ª–∏:
  - [x] –ï—Å–ª–∏ –ø–∞–Ω–µ–ª—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è - –ø–æ–∫–∞–∑–∞—Ç—å InitialPage, –Ω–µ —É–¥–∞–ª—è—Ç—å –ø–∞–Ω–µ–ª—å
  - [x] –ï—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞–Ω–µ–ª–∏ - —É–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—É—é –ø–∞–Ω–µ–ª—å
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Splitpanes
- [x] –û–±–Ω–æ–≤–∏—Ç—å orgnote-api —Å –Ω–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ)
- [x] –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è layout
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [x] –°–æ–±–ª—é–¥–µ–Ω–∏–µ mobile-first –ø–æ–¥—Ö–æ–¥–∞ (desktop - enhancement)

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏

### üî¥ –ö–†–ò–¢–ò–ß–ù–û: Bug #1 - –ù–µ–≤–µ—Ä–Ω—ã–µ ID –ø–∞–Ω–µ–ª–µ–π –≤ PanesPage.vue

**–§–∞–π–ª:** `src/pages/PanesPage.vue:9-10`

**–ü—Ä–æ–±–ª–µ–º–∞:**

```vue
<pane v-for="(_, i) of panes" :key="i">
  <app-pane :pane-id="`${i}`" />
</pane>
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –º–∞—Å—Å–∏–≤–∞ (`"0"`, `"1"`) –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö UUID –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø–∞–Ω–µ–ª–µ–π –∏–∑ `panes: Record<string, Pane>`.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- Desktop –ø–∞–Ω–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã
- AppPane –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π ID –∏ –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏
- –í–∫–ª–∞–¥–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```vue
<pane v-for="paneId in Object.keys(panes)" :key="paneId">
  <app-pane :pane-id="paneId" />
</pane>
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

**–¢–µ—Å—Ç—ã:** ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ `src/pages/PanesPage.spec.ts`

---

### üî¥ –ö–†–ò–¢–ò–ß–ù–û: Bug #2 - –ù–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–π –∫–æ–¥ –æ—á–∏—Å—Ç–∫–∏ –ø—É—Å—Ç–æ–π –ø–∞–Ω–µ–ª–∏

**–§–∞–π–ª:** `src/stores/pane.ts:140-163`

**–ü—Ä–æ–±–ª–µ–º–∞:**

```typescript
const closeTab = async (tabId: string) => {
  // ... —É–¥–∞–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ ...

  const hasRemainingTabs = currentPane.tabs.length > 0;
  if (hasRemainingTabs) {
    // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –¥—Ä—É–≥—É—é –≤–∫–ª–∞–¥–∫—É
    return;
  }

  // –≠—Ç–∞ —á–∞—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª–∞–¥–æ–∫ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å
  await router.push({ name: 'initial' }); // üî¥ Early return —á–µ—Ä–µ–∑ navigation

  // –ö–æ–¥ –Ω–∏–∂–µ –ù–ò–ö–û–ì–î–ê –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –∏–∑-–∑–∞ await router.push –≤—ã—à–µ
  cleanupEmptyPane(activePaneId.value);
};
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ü—É—Å—Ç—ã–µ –ø–∞–Ω–µ–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- –ü–∞–º—è—Ç—å –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –ø–∞–Ω–µ–ª—è–º–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—É—Å—Ç–æ–π –ø–∞–Ω–µ–ª–∏

**–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ:**

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ–≤–æ—Ä–∏—Ç: "—É–¥–∞–ª–∏—Ç—å –ø–∞–Ω–µ–ª—å –µ—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ"
- –ö–æ–¥ –≤—Å–µ–≥–¥–∞ —Ç–æ–ª—å–∫–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ä–æ—É—Ç –Ω–∞ InitialPage
- `cleanupEmptyPane` –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

```typescript
const hasRemainingTabs = currentPane.tabs.length > 0;
if (hasRemainingTabs) {
  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥—É—é –≤–∫–ª–∞–¥–∫—É
  return;
}

// –ù–µ—Ç –≤–∫–ª–∞–¥–æ–∫ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–Ω–µ–ª–µ–π
const paneCount = Object.keys(panes.value).length;
if (paneCount > 1) {
  // –ï—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞–Ω–µ–ª–∏ - —É–¥–∞–ª—è–µ–º —ç—Ç—É
  cleanupEmptyPane(activePaneId.value);
  return;
}

// –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–∞–Ω–µ–ª—å - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º InitialPage
await router.push({ name: 'initial' });
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

**–¢–µ—Å—Ç—ã:** ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ `src/stores/pane.spec.ts` (3 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–∞)

---

### üü° –í–ê–ñ–ù–û: Bug #3 - –ü–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ splits

**–§–∞–π–ª:** `src/stores/pane.ts:55`

**–ü—Ä–æ–±–ª–µ–º–∞:**

```typescript
const panes = ref<Record<string, Pane>>({});
```

–¢–µ–∫—É—â–∞—è –ø–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `Record<string, Pane>` –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ/–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –ø–∞–Ω–µ–ª–∏ A
2. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –≤–∫–ª–∞–¥–∫—É –≤–ø—Ä–∞–≤–æ ‚Üí [A | B] (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π split)
3. –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –≤–∫–ª–∞–¥–∫—É B –≤–Ω–∏–∑ ‚Üí [A | [B –Ω–∞–¥ C]] (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π + –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π)
```

**–¢—Ä–µ–±—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```typescript
type LayoutNode = {
  type: 'pane' | 'split';
  id: string;
} & (
  | { type: 'pane'; paneId: string }
  | {
      type: 'split';
      orientation: 'horizontal' | 'vertical';
      children: LayoutNode[];
      sizes: number[];
    }
);
```

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (—ç—Ç–∞–ø 3)

---

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ ‚úÖ

- [x] **Bug #1:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pane ID –≤ PanesPage.vue
  - [x] –ó–∞–º–µ–Ω–∏—Ç—å `v-for="(_, i) of panes"` –Ω–∞ `v-for="paneId in Object.keys(panes)"`
  - [x] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π `paneId` –≤ AppPane
  - [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ desktop
- [x] **Bug #2:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É `closeTab` –≤ pane.ts
  - [x] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞–Ω–µ–ª–µ–π
  - [x] –í—ã–∑—ã–≤–∞—Ç—å `cleanupEmptyPane` –¥–ª—è –Ω–µ-–ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–∞–Ω–µ–ª–∏
  - [x] –û—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –ø–∞–Ω–µ–ª—å —Å InitialPage
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –≠—Ç–∞–ø 2: –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ layout (TDD –ø–æ–¥—Ö–æ–¥)

- [x] –û–±–Ω–æ–≤–∏—Ç—å orgnote-api (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ)

  - [x] –î–æ–±–∞–≤–∏—Ç—å `LayoutNode` type
  - [x] –î–æ–±–∞–≤–∏—Ç—å `orientation: 'horizontal' | 'vertical'`
  - [x] –û–±–Ω–æ–≤–∏—Ç—å PaneStore interface
  - [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è drop zones

**–¢—Ä–µ–±—É–µ–º—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è orgnote-api:**

```typescript
// 1. –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –¥–ª—è layout
export type LayoutOrientation = 'horizontal' | 'vertical';

export type DropZone = 'left' | 'right' | 'top' | 'bottom' | 'center';

export type DropDirection = 'left' | 'right' | 'top' | 'bottom';

// 2. –£–∑–ª—ã –¥–µ—Ä–µ–≤–∞ layout
export type LayoutNode = LayoutPaneNode | LayoutSplitNode;

export interface LayoutPaneNode {
  type: 'pane';
  id: string;
  paneId: string; // UUID –ø–∞–Ω–µ–ª–∏ –∏–∑ Record<string, Pane>
}

export interface LayoutSplitNode {
  type: 'split';
  id: string;
  orientation: LayoutOrientation;
  children: LayoutNode[];
  sizes?: number[]; // –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è Splitpanes (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
}

// 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π PaneStore interface
export interface PaneStore {
  // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  panes: Record<string, Pane>;
  activePaneId: string;

  // –ù–û–í–û–ï: –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ layout
  layout: LayoutNode;

  // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã
  initNewPane: (tab: Tab) => void;
  cleanupEmptyPane: (paneId: string) => void;
  closeTab: (tabId: string) => Promise<void>;
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã

  // –ù–û–í–´–ï –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å layout
  initLayout: () => void;
  findPaneInLayout: (paneId: string, node?: LayoutNode) => LayoutNode | null;
  splitPaneInLayout: (paneId: string, direction: DropDirection) => void;
  removePaneFromLayout: (paneId: string) => void;
  moveTab: (tabId: string, sourcePaneId: string, targetPaneId: string) => void;
}

// 4. –¢–∏–ø—ã –¥–ª—è drag-and-drop
export interface DragData {
  tabId: string;
  sourcePaneId: string;
}

export interface DropTarget {
  paneId: string;
  zone: DropZone;
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**

- `LayoutNode` - –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π union type (`type: 'pane' | 'split'`)
- `paneId` –≤ `LayoutPaneNode` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –≤ `Record<string, Pane>`
- `sizes` –≤ `LayoutSplitNode` –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
- –í—Å–µ ID –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `crypto.randomUUID()`

- [x] –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã –∏ —Å—Ö–µ–º—ã (TDD: —Å–Ω–∞—á–∞–ª–∞ —Ç–∏–ø—ã, –ø–æ—Ç–æ–º —Ç–µ—Å—Ç—ã)

  - [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å `LayoutNode` –≤ `src/models/layout-node.ts` (—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç –∏–∑ orgnote-api)
  - [x] –î–æ–±–∞–≤–∏—Ç—å valibot —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–≤ orgnote-api)
  - [x] –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã –¥–ª—è drop zones (–≤ orgnote-api)

- [x] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ pane store (TDD: –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã ‚Üí —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)

  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `layout: Ref<LayoutNode>`
  - [x] –î–æ–±–∞–≤–∏—Ç—å `layout` –≤–º–µ—Å—Ç–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `panes: Record<string, Pane>`
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `initLayout()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —É–∑–ª–∞
  - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `initLayout()`
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `findPaneInLayout(paneId)` - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫
  - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `findPaneInLayout()`
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `splitPaneInLayout(paneId, direction)` - 4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `splitPaneInLayout()`
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `removePaneFromLayout(paneId)` - —É–¥–∞–ª–µ–Ω–∏–µ —Å —É–ø—Ä–æ—â–µ–Ω–∏–µ–º –¥–µ—Ä–µ–≤–∞
  - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `removePaneFromLayout()`
  - [x] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `moveTab(tabId, sourcePaneId, targetPaneId)` - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
  - [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `moveTab()`
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è edge cases (–ø–æ—Å–ª–µ–¥–Ω—è—è –ø–∞–Ω–µ–ª—å, –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å, etc.)
  - [ ] –û–±–Ω–æ–≤–∏—Ç—å `cleanupEmptyPane()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å layout tree

- [ ] –°–æ–∑–¥–∞—Ç—å LayoutRenderer.vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (TDD)

  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
  - [ ] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å —Ä–µ–∫—É—Ä—Å–∏–µ–π
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è split —É–∑–ª–æ–≤ (horizontal/vertical)
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ Splitpanes –¥–ª—è split —É–∑–ª–æ–≤
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è pane —É–∑–ª–æ–≤
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ AppPane –¥–ª—è pane —É–∑–ª–æ–≤
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ sizes
  - [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É sizes –≤ Splitpanes

- [ ] –û–±–Ω–æ–≤–∏—Ç—å PanesPage.vue (TDD)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è LayoutRenderer
  - [ ] –ó–∞–º–µ–Ω–∏—Ç—å –ø—Ä—è–º–æ–π Splitpanes –Ω–∞ LayoutRenderer
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ layout node
  - [ ] –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `layout` –∏–∑ store –≤ LayoutRenderer

### –≠—Ç–∞–ø 3: Drag-and-Drop —Å 5 –∑–æ–Ω–∞–º–∏ (TDD –ø–æ–¥—Ö–æ–¥)

- [ ] –ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ drag-and-drop (TDD)

  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è drop –∑–æ–Ω—ã (5 –∑–æ–Ω)
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `getDropZone(x, y, rect)` —É—Ç–∏–ª–∏—Ç—É
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ min —Ä–∞–∑–º–µ—Ä–∞ (15%)
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–æ–≤

- [ ] –û–±–Ω–æ–≤–∏—Ç—å NavTab.vue (TDD)

  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è draggable —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  - [ ] –î–æ–±–∞–≤–∏—Ç—å `draggable="true"` –∏ data transfer
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è dragstart/dragend –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º —Ñ–∏–¥–±–µ–∫–æ–º

- [ ] –û–±–Ω–æ–≤–∏—Ç—å AppPane.vue (TDD)

  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è 5 drop –∑–æ–Ω
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É –∏ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–æ–Ω
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–∏
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π –∑–æ–Ω—ã
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è drop –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å dragover/drop –ª–æ–≥–∏–∫—É

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å pane store (TDD)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `moveTab(tabId, sourcePaneId, targetPaneId)`
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ (center –∑–æ–Ω–∞)
  - [ ] –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è split –æ–ø–µ—Ä–∞—Ü–∏–π
  - [ ] –°–≤—è–∑–∞—Ç—å drop –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å `splitPaneInLayout()`

### –≠—Ç–∞–ø 4: UX —É–ª—É—á—à–µ–Ω–∏—è –∏ –ø–æ–ª–∏—Ä–æ–≤–∫–∞

- [ ] –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è drop –∑–æ–Ω

  - [ ] –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞
  - [ ] Preview —Ä–∞–∑–º–µ—Ä–æ–≤ split
  - [ ] Smooth transitions

- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞–º–∏

  - [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ sizes –≤ layout node
  - [ ] Persist layout –≤ localStorage
  - [ ] Reset to default —Ñ—É–Ω–∫—Ü–∏—è

- [ ] Keyboard shortcuts (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

  - [ ] –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏ (Ctrl+W + hjkl)
  - [ ] –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ (Ctrl+W q)
  - [ ] Split shortcuts (Ctrl+W s/v)

- [ ] Manual QA –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

  - [ ] –ü–æ–ª–Ω—ã–π flow drag-and-drop
  - [ ] –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ splits
  - [ ] Close –∏ cleanup –ø—É—Å—Ç—ã—Ö –ø–∞–Ω–µ–ª–µ–π

- [ ] Manual QA
  - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö desktop
  - [ ] Edge cases (–±—ã—Å—Ç—Ä—ã–µ drags, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è)
  - [ ] Performance —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–∞–Ω–µ–ª–µ–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ layout

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É—é –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è layout.

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

1. Splitpanes —Ç—Ä–µ–±—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–π
2. –ü–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ horizontal+vertical splits
3. 4-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π split —Ç—Ä–µ–±—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏
4. –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ - –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –¥–µ—Ä–µ–≤—å–µ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**

```typescript
type LayoutNode = {
  id: string;
} & (
  | {
      type: 'pane';
      paneId: string; // —Å—Å—ã–ª–∫–∞ –Ω–∞ Pane –≤ Record<string, Pane>
    }
  | {
      type: 'split';
      orientation: 'horizontal' | 'vertical';
      children: LayoutNode[];
      sizes?: number[]; // –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è Splitpanes
    }
);

// –í store:
const layout = ref<LayoutNode>({ type: 'pane', id: '...', paneId: '...' });
const panes = ref<Record<string, Pane>>({}); // –¥–∞–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–µ–π
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞):** –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ left/right splits —Å –ø–ª–æ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

- **–ú–∏–Ω—É—Å—ã:** –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (–Ω—É–∂–Ω—ã –≤—Å–µ 4 –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è), –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç UX.

### –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π LayoutRenderer

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ layout tree.

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**

1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (SRP)
2. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å –¥–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —É–∑–ª–æ–≤
3. –ß–∏—Å—Ç–æ—Ç–∞ PanesPage.vue
4. –õ–µ–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```vue
<!-- LayoutRenderer.vue -->
<template>
  <app-pane v-if="node.type === 'pane'" :pane-id="node.paneId" />

  <splitpanes v-else :horizontal="node.orientation === 'horizontal'">
    <pane v-for="child in node.children" :key="child.id" :size="sizes[i]">
      <layout-renderer :node="child" />
    </pane>
  </splitpanes>
</template>
```

### Drop –∑–æ–Ω—ã - 5 —Ä–µ–≥–∏–æ–Ω–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –ø–∞–Ω–µ–ª–∏ –Ω–∞ 5 –∑–æ–Ω —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –∫—Ä–∞–µ–≤.

**–ö–∞—Ä—Ç–∞ –∑–æ–Ω:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    TOP (15%)        ‚îÇ
‚îú‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î§
‚îÇL ‚îÇ   CENTER     ‚îÇ R ‚îÇ
‚îÇE ‚îÇ   (40%)      ‚îÇ I ‚îÇ
‚îÇF ‚îÇ              ‚îÇ G ‚îÇ
‚îÇT ‚îÇ              ‚îÇ H ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ T ‚îÇ
‚îÇ1 ‚îÇ              ‚îÇ   ‚îÇ
‚îÇ5 ‚îÇ              ‚îÇ 1 ‚îÇ
‚îÇ% ‚îÇ              ‚îÇ 5 ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ % ‚îÇ
‚îú‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   BOTTOM (15%)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω—ã:**

```typescript
const getDropZone = (x: number, y: number, rect: DOMRect): DropZone => {
  const relX = (x - rect.left) / rect.width;
  const relY = (y - rect.top) / rect.height;

  if (relX < 0.15) return 'left';
  if (relX > 0.85) return 'right';
  if (relY < 0.15) return 'top';
  if (relY > 0.85) return 'bottom';
  return 'center';
};
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- ‚úÖ `splitpanes` - —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ `vue` / `pinia` / `vue-router` - core dependencies

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- ‚è≥ `orgnote-api` - —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ (–¥–µ–ª–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
  - `LayoutNode` type
  - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `PaneStore` interface
  - Drop zone types

## –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

1. **Performance –ø—Ä–∏ –≥–ª—É–±–æ–∫–∏—Ö –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—è—Ö**

   - –†–∏—Å–∫: –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–ª—É–±–∏–Ω—É –¥–µ—Ä–µ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 —É—Ä–æ–≤–Ω–µ–π)
   - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–µ–¥–∫–æ —Å–æ–∑–¥–∞—é—Ç >5 —É—Ä–æ–≤–Ω–µ–π)

2. **Splitpanes –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**

   - –†–∏—Å–∫: –ë–∞–≥–∏ –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–º–µ–Ω—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
   - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è

3. **State —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
   - –†–∏—Å–∫: –î–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è layout tree –∏ panes Record
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: Single source of truth, –≤–∞–ª–∏–¥–∞—Ü–∏—è integrity
   - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è

### UX –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–æ–ª—å–∫–æ desktop** - mobile –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä 15%** - –Ω–µ –±–æ–ª–µ–µ 6 –ø–∞–Ω–µ–ª–µ–π –≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
3. **–ù–µ—Ç drag-and-drop –≤—Å–µ–π –ø–∞–Ω–µ–ª–∏** - —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è Bug #1

```typescript
test('PanesPage passes correct pane UUID to AppPane', () => {
  const paneStore = usePaneStore();
  paneStore.panes = {
    'abc-123': { id: 'abc-123', tabs: [...] },
    'def-456': { id: 'def-456', tabs: [...] }
  };

  const wrapper = mount(PanesPage);
  const appPanes = wrapper.findAllComponents(AppPane);

  expect(appPanes[0].props('paneId')).toBe('abc-123');
  expect(appPanes[1].props('paneId')).toBe('def-456');
});
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è Bug #2

```typescript
test('closeTab removes pane when other panes exist', async () => {
  const paneStore = usePaneStore();
  paneStore.panes = {
    'pane-1': { id: 'pane-1', tabs: ['tab-1'] },
    'pane-2': { id: 'pane-2', tabs: ['tab-2'] },
  };
  paneStore.activePaneId = 'pane-1';

  await paneStore.closeTab('tab-1');

  expect(paneStore.panes['pane-1']).toBeUndefined();
  expect(paneStore.panes['pane-2']).toBeDefined();
});

test('closeTab keeps last pane and shows InitialPage', async () => {
  const paneStore = usePaneStore();
  paneStore.panes = {
    'pane-1': { id: 'pane-1', tabs: ['tab-1'] },
  };
  paneStore.activePaneId = 'pane-1';

  await paneStore.closeTab('tab-1');

  expect(paneStore.panes['pane-1']).toBeDefined();
  expect(router.currentRoute.value.name).toBe('initial');
});
```

### Drag-and-drop —Ç–µ—Å—Ç—ã

```typescript
test('dropping tab on left edge creates new left pane', async () => {
  const paneStore = usePaneStore();
  // ... setup initial state

  await simulateDragDrop(tab, { zone: 'left', targetPaneId: 'pane-1' });

  expect(paneStore.layout.type).toBe('split');
  expect(paneStore.layout.orientation).toBe('horizontal');
  expect(paneStore.layout.children.length).toBe(2);
});

test('dropping tab on center moves tab without creating pane', async () => {
  const paneStore = usePaneStore();
  // ... setup panes with tabs

  await simulateDragDrop(tab, { zone: 'center', targetPaneId: 'pane-2' });

  expect(paneStore.panes['pane-2'].tabs).toContain(tab.id);
  expect(Object.keys(paneStore.panes).length).toBe(2); // no new pane
});
```

## Checklist —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–µ–º–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] Desktop: Drag –≤–∫–ª–∞–¥–∫–∏ –Ω–∞ –ª–µ–≤—ã–π –∫—Ä–∞–π —Å–æ–∑–¥–∞–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π split
- [ ] Desktop: Drag –≤–∫–ª–∞–¥–∫–∏ –Ω–∞ –ø—Ä–∞–≤—ã–π –∫—Ä–∞–π —Å–æ–∑–¥–∞–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π split
- [ ] Desktop: Drag –≤–∫–ª–∞–¥–∫–∏ –Ω–∞ –≤–µ—Ä—Ö–Ω–∏–π –∫—Ä–∞–π —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π split
- [ ] Desktop: Drag –≤–∫–ª–∞–¥–∫–∏ –Ω–∞ –Ω–∏–∂–Ω–∏–π –∫—Ä–∞–π —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π split
- [ ] Desktop: Drag –≤–∫–ª–∞–¥–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–Ω–µ–ª–∏
- [ ] Desktop: –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∑–æ–Ω—ã –ø—Ä–∏ hover
- [ ] Desktop: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–Ω–µ–ª–∏ 15% —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è
- [ ] Desktop: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–∫–ª–∞–¥–∫–∏ –≤ –Ω–µ-–ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–∞–Ω–µ–ª–∏ —É–¥–∞–ª—è–µ—Ç –ø–∞–Ω–µ–ª—å
- [ ] Desktop: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–∫–ª–∞–¥–∫–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç InitialPage
- [ ] Desktop: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ splits (horizontal+vertical) —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Desktop: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ layout –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- [ ] Mobile: –ü–∞–Ω–µ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ (–Ω–µ desktop-above)
- [ ] Mobile: Drag-and-drop –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] –í—Å–µ unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –í—Å–µ integration —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] ESLint –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] TypeScript strict mode –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] No performance regressions

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–Ω–æ–≤–∏—Ç—å:

- [ ] `DOCUMENTATION.org` - –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø–∞–Ω–µ–ª–µ–π
- [ ] `PANES.org` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–Ω–µ–ª–µ–π –∏ layout
- [ ] `README.org` - —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ drag-and-drop —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [ ] Storybook stories –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- [ ] API docs –¥–ª—è –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ pane store

## –í–æ–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—â–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è

1. ‚úÖ **–î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ vs —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è** - –†–µ—à–µ–Ω–æ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tree
2. ‚è≥ **Persist layout –≤ localStorage?** - –î–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è
3. ‚è≥ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏?** - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 10 —É—Ä–æ–≤–Ω–µ–π
4. ‚è≥ **Keyboard shortcuts –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–Ω–µ–ª—è–º–∏?** - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—ç—Ç–∞–ø 4)
5. ‚è≥ **–ê–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ split/merge?** - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—ç—Ç–∞–ø 4)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-05  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-05  
**–°—Ç–∞—Ç—É—Å:** üü¢ –ì–æ—Ç–æ–≤ –∫ –≠—Ç–∞–ø—É 2 - –≠—Ç–∞–ø 1 –∑–∞–≤–µ—Ä—à–µ–Ω (20/20 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–ª–∞–Ω–µ

**2025-10-05:** –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã —ç—Ç–∞–ø—ã 2 –∏ 3 –≤ –µ–¥–∏–Ω—ã–π —ç—Ç–∞–ø 2 —Å –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π. –†–µ—à–µ–Ω–æ —Å—Ä–∞–∑—É —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤–º–µ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è —Å `paneOrder[]`. –í—Å–µ —ç—Ç–∞–ø—ã —Ç–µ–ø–µ—Ä—å —Å–ª–µ–¥—É—é—Ç —Å—Ç—Ä–æ–≥–æ–º—É TDD –ø–æ–¥—Ö–æ–¥—É.
